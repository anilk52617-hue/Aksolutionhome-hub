<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AK SOLUTION HUB</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --primary: #005eb8; --success: #27ae60; --warning: #f1c40f; --danger: #e74c3c; --dark: #1a1a1a; }
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; }
        body { background: #fff; padding-bottom: 90px; overflow-x: hidden; }
        
        /* --- HOME PAGE STYLES --- */
        .header { text-align: center; padding: 10px; background: #fff; border-bottom: 1px solid #ddd; position: relative; }
        .logo-img { width: 70px; height: 70px; border-radius: 50%; border: 2px solid var(--primary); cursor: pointer; transition: 0.3s; }
        .logo-img:active { transform: scale(0.9); }
        .ticker { background: var(--primary); color: #fff; padding: 8px; overflow: hidden; white-space: nowrap; font-size: 13px; font-weight: bold; }
        .slider-box { width: 94%; margin: 15px auto; border-radius: 15px; overflow: hidden; height: 165px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .slider { display: flex; transition: 0.5s ease; height: 100%; width: 500%; }
        .slider img { width: 20%; object-fit: cover; }
        .page { display: none; padding: 15px; animation: fadeIn 0.3s; }
        .active-page { display: block !important; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .box { background: #f8f9fa; border-radius: 12px; height: 90px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 1px solid #eee; cursor: pointer; text-align: center; }
        .box i { font-size: 22px; color: var(--primary); margin-bottom: 5px; }
        .box span { font-size: 9px; font-weight: 800; text-transform: uppercase; }
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: #fff; display: flex; height: 75px; border-top: 1px solid #eee; z-index: 1000; }
        .nav-item { flex: 1; text-align: center; color: #666; font-size: 11px; padding-top: 15px; }
        .active-nav { color: var(--primary); font-weight: bold; }

        /* --- MASTER ADMIN STYLES (NO CONFLICT) --- */
        #admin-main-panel { display: none; background: #f0f2f5; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10000; overflow-y: auto; }
        .admin-card { background: white; padding: 15px; border-radius: 15px; border: 2px solid #000; margin: 15px; box-shadow: 4px 4px 0px #000; }
        .admin-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 15px; }
        .admin-box { background: #fff; border: 2px solid #000; border-radius: 15px; padding: 20px; text-align: center; box-shadow: 4px 4px 0px #000; cursor: pointer; }
        .admin-box i { font-size: 28px; color: var(--primary); margin-bottom: 8px; }
        .admin-box span { display: block; font-size: 12px; font-weight: bold; }
        
        /* Common UI */
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:20000; }
        .modal-content { position:relative; top:50%; left:50%; transform:translate(-50%,-50%); width:90%; max-height: 85vh; background:white; padding:20px; border-radius:15px; border:3px solid #000; overflow-y: auto; }
        .input-f { width: 100%; padding: 12px; margin: 8px 0; border: 2px solid #000; border-radius: 10px; font-size: 15px; outline: none; }
        .btn-f { width: 100%; padding: 15px; border: none; border-radius: 10px; color: white; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 14px; }
    </style>
</head>
<body>

<div id="user-view">
    <div class="header">
        <img src="57255.jpg" class="logo-img" onclick="adminTrigger()">
        <h1>AK SOLUTION HUB</h1>
    </div>
    <div class="ticker"><marquee>‚ö° ‡§∏‡•Ä‡§∏‡•Ä‡§ü‡•Ä‡§µ‡•Ä | ‡§Ü‡§∞‡§ì | ‡§™‡•ç‡§≤‡§Ç‡§¨‡§∞ | ‡§ï‡§æ‡§∞‡§™‡•á‡§Ç‡§ü‡§∞ | ‡§è‡§∏‡•Ä ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ | 9927464530 ‚ö°</marquee></div>

    <div id="home-page" class="page active-page">
        <div class="slider-box"><div class="slider" id="mainSlider"><img src="1.jpg"><img src="2.jpg"><img src="3.jpg"><img src="4.jpg"><img src="5.jpg"></div></div>
        <div class="grid">
            <div class="box" onclick="openSub('PLUMBER')"><i class="fas fa-faucet"></i><span>PLUMBER</span></div>
            <div class="box" onclick="openSub('ELECTRICIAN')"><i class="fas fa-bolt"></i><span>ELECTRICIAN</span></div>
            <div class="box" onclick="openSub('CARPENTER')"><i class="fas fa-hammer"></i><span>CARPENTER</span></div>
            <div class="box" onclick="openSub('RO SERVICE')"><i class="fas fa-tint"></i><span>RO SERVICE</span></div>
            <div class="box" onclick="openSub('CCTV')"><i class="fas fa-video"></i><span>CCTV</span></div>
            <div class="box" onclick="openSub('AC SERVICE')"><i class="fas fa-snowflake"></i><span>AC SERVICE</span></div>
            <div class="box" onclick="openSub('CLEANING')"><i class="fas fa-broom"></i><span>CLEANING</span></div>
            <div class="box" onclick="openSub('FITTING')"><i class="fas fa-tools"></i><span>FITTING</span></div>
            <div class="box" onclick="openSub('OTHER')"><i class="fas fa-plus-circle"></i><span>OTHER</span></div>
        </div>
    </div>

    <div id="booking-page" class="page">
        <h3 style="text-align:center; color:var(--primary);">‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§µ‡§ø‡§µ‡§∞‡§£</h3>
        <input type="text" id="selSvc" class="input-f" readonly style="background:#eee;">
        <input type="text" id="uName" class="input-f" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ">
        <input type="tel" id="uPhone" class="input-f" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞">
        <textarea id="uAddr" class="input-f" rows="3" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§™‡§§‡§æ"></textarea>
        <button class="btn-f" style="background:#3498db;" onclick="getLoc()" id="locBtn">üìç ‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§ï‡§®‡•ç‡§´‡§∞‡•ç‡§Æ ‡§ï‡§∞‡•á‡§Ç</button>
        <button class="btn-f" style="background:var(--success); display:none;" onclick="submitBooking()" id="finalBtn">‚úÖ ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§®‡•ç‡§´‡§∞‡•ç‡§Æ</button>
    </div>

    <div id="track-page" class="page">
        <h2 style="text-align:center;">‡§ü‡•ç‡§∞‡•à‡§ï ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏</h2>
        <input type="text" id="tId" class="input-f" placeholder="‡§Ö‡§™‡§®‡•Ä ID ‡§°‡§æ‡§≤‡•á‡§Ç" style="text-align:center;">
        <button class="btn-f" style="background:var(--primary);" onclick="trackJob()">‡§ñ‡•ã‡§ú‡•á‡§Ç</button>
        <div id="tRes" style="display:none; margin-top:15px; padding:15px; border:2px solid var(--primary); border-radius:10px; text-align:center;">
            <p>‡§∏‡•ç‡§•‡§ø‡§§‡§ø: <b id="tStat" style="color:var(--danger);"></b></p>
        </div>
    </div>

    <nav class="nav-bar">
        <div class="nav-item active-nav" onclick="showPage('home-page', this)"><i class="fas fa-home"></i><br>Home</div>
        <div class="nav-item" onclick="showPage('booking-page', this)"><i class="fas fa-calendar-alt"></i><br>Booking</div>
        <div class="nav-item" onclick="showPage('track-page', this)"><i class="fas fa-search"></i><br>Track</div>
    </nav>
</div>

<div id="admin-main-panel">
    <div style="background:var(--dark); color:white; padding:15px; text-align:center; position:relative;">
        <h3>AK MASTER ADMIN</h3>
        <i class="fas fa-times" onclick="location.reload()" style="position:absolute; right:20px; top:20px; font-size:20px;"></i>
    </div>

    <div class="admin-card">
        <h4 style="text-align:center; margin-bottom:10px;">üìä ‡§ï‡•ç‡§µ‡§ø‡§ï ‡§Ö‡§™‡§°‡•á‡§ü</h4>
        <input type="text" id="targetId" class="input-f" placeholder="‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞ ID ‡§Ø‡§π‡§æ‡§Å ‡§°‡§æ‡§≤‡•á‡§Ç" style="text-align:center;">
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
            <button class="btn-f" style="background:var(--success); margin:0;" onclick="upStat('DONE')">DONE</button>
            <button class="btn-f" style="background:var(--warning); color:#000; margin:0;" onclick="upStat('PENDING')">PENDING</button>
            <button class="btn-f" style="background:#3498db; margin:0;" onclick="upStat('RUNNING')">RUNNING</button>
            <button class="btn-f" style="background:var(--danger); margin:0;" onclick="upStat('REJECT')">REJECT</button>
        </div>
    </div>

    <div class="admin-grid">
        <div class="admin-box" onclick="openModal('reg-modal')"><i class="fas fa-user-plus"></i><span>TEAM REG</span></div>
        <div class="admin-box" onclick="loadData('CUST')"><i class="fas fa-database"></i><span>CUST DATA</span></div>
        <div class="admin-box" onclick="loadData('TEAM')"><i class="fas fa-users-cog"></i><span>TEAM LIST</span></div>
        <div class="admin-box" onclick="openModal('id-modal')"><i class="fas fa-id-card"></i><span>ID CARD</span></div>
        <div class="admin-box" onclick="openModal('as-modal')"><i class="fas fa-link"></i><span>ASSIGN</span></div>
        <div class="admin-box" onclick="location.reload()"><i class="fas fa-sync-alt"></i><span>REFRESH</span></div>
    </div>
</div>

<div id="login-modal" class="modal">
    <div class="modal-content" style="text-align:center;">
        <h3>üîê ‡§è‡§°‡§Æ‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§®</h3>
        <input type="password" id="adminPass" class="input-f" placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§°‡§æ‡§≤‡•á‡§Ç">
        <button class="btn-f" style="background:var(--primary)" onclick="checkPass()">‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§ï‡§∞‡•á‡§Ç</button>
        <button class="btn-f" style="background:#666" onclick="closeModal('login-modal')">‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
    </div>
</div>

<div id="reg-modal" class="modal"><div class="modal-content">
    <h3>üë∑ ‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§®</h3>
    <input type="text" id="rName" class="input-f" placeholder="‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ">
    <input type="tel" id="rPhone" class="input-f" placeholder="‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§®‡§Ç‡§¨‡§∞">
    <textarea id="rAddr" class="input-f" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§™‡§§‡§æ"></textarea>
    <button class="btn-f" style="background:var(--success)" onclick="alert('‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§∂‡•Å‡§∞‡•Ç...')">‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
    <button class="btn-f" style="background:var(--danger)" onclick="closeModal('reg-modal')">‡§ï‡•à‡§Ç‡§∏‡§ø‡§≤</button>
</div></div>

<div id="id-modal" class="modal"><div class="modal-content">
    <h3>ü™™ ‡§Ü‡§à‡§°‡•Ä ‡§ï‡§æ‡§∞‡•ç‡§° ‡§™‡•à‡§®‡§≤</h3>
    <input type="text" id="idWorker" class="input-f" placeholder="‡§µ‡§∞‡•ç‡§ï‡§∞ ID ‡§°‡§æ‡§≤‡•á‡§Ç">
    <button class="btn-f" style="background:var(--primary)" onclick="alert('‡§Ü‡§à‡§°‡•Ä ‡§ú‡•á‡§®‡§∞‡•á‡§ü ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...')">‡§ú‡•á‡§®‡§∞‡•á‡§ü ID</button>
    <button class="btn-f" style="background:var(--danger)" onclick="closeModal('id-modal')">‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
</div></div>

<div id="as-modal" class="modal"><div class="modal-content">
    <h3>üîó ‡§ï‡§æ‡§Æ ‡§∏‡•å‡§Ç‡§™‡•á‡§Ç (Assign)</h3>
    <input type="text" id="asC" class="input-f" placeholder="‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞ ID">
    <input type="text" id="asW" class="input-f" placeholder="‡§µ‡§∞‡•ç‡§ï‡§∞ ID">
    <input type="tel" id="asPh" class="input-f" placeholder="‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤">
    <button class="btn-f" style="background:#25d366" onclick="sendWA()">WhatsApp ‡§≠‡•á‡§ú‡•á‡§Ç</button>
    <button class="btn-f" style="background:var(--danger)" onclick="closeModal('as-modal')">‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
</div></div>

<div id="list-modal" class="modal"><div class="modal-content">
    <h3 id="ltitle">‡§°‡•á‡§ü‡§æ ‡§≤‡§ø‡§∏‡•ç‡§ü</h3>
    <div id="lbody" style="margin-top:15px; border-top:1px solid #eee; padding-top:10px; font-size:13px;">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
    <button class="btn-f" style="background:var(--dark)" onclick="closeModal('list-modal')">‡§µ‡§æ‡§™‡§∏</button>
</div></div>

<div id="subModal" class="modal"><div class="modal-content">
    <h3 id="mTitle" style="text-align:center; color:var(--primary);"></h3>
    <div id="mList" class="grid" style="grid-template-columns: 1fr 1fr; margin-top:15px;"></div>
    <button onclick="closeModal('subModal')" class="btn-f" style="background:#333">‡§™‡•Ä‡§õ‡•á ‡§ú‡§æ‡§è‡§Å</button>
</div></div>

<script>
    const scriptURL = 'Https://script.google.com/macros/s/AKfycbxyXjEGJq0GmvcPVz7ceuYP4B9enRxXXlhhhEdwObuAEFds4AXiNFkqCsGT5zY6PBo_MQ/exec';
    
    // Admin Toggle (3 Clicks)
    let clicks = 0;
    function adminTrigger() {
        clicks++;
        if(clicks === 3) { openModal('login-modal'); clicks = 0; }
    }

    function checkPass() {
        const p = document.getElementById('adminPass').value;
        if(p === "Ak2525") {
            closeModal('login-modal');
            document.getElementById('user-view').style.display = 'none';
            document.getElementById('admin-main-panel').style.display = 'block';
        } else { alert("‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°!"); }
    }

    // Navigation & Modals
    function showPage(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
        document.getElementById(id).classList.add('active-page');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active-nav'));
        if(el) el.classList.add('active-nav');
    }

    function openModal(id) { document.getElementById(id).style.display = 'block'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }

    // Logic Functions
    function openSub(cat) {
        const list = document.getElementById('mList');
        document.getElementById('mTitle').innerText = cat;
        list.innerHTML = "";
        const svcs = {
            'PLUMBER': ['‡§®‡§≤ ‡§∞‡§ø‡§™‡•á‡§Ø‡§∞', '‡§≤‡•Ä‡§ï‡•á‡§ú', '‡§®‡§à ‡§´‡§ø‡§ü‡§ø‡§Ç‡§ó'],
            'ELECTRICIAN': ['‡§™‡§Ç‡§ñ ‡§∞‡§ø‡§™‡•á‡§Ø‡§∞', '‡§µ‡§æ‡§Ø‡§∞‡§ø‡§Ç‡§ó', '‡§¨‡•ã‡§∞‡•ç‡§°'],
            'CARPENTER': ['‡§≤‡•â‡§ï ‡§∞‡§ø‡§™‡•á‡§Ø‡§∞', '‡§ï‡•Å‡§∞‡•ç‡§∏‡•Ä', '‡§Ö‡§≤‡§Æ‡§æ‡§∞‡•Ä'],
            'RO SERVICE': ['‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏‡§ø‡§Ç‡§ó', '‡•û‡§ø‡§≤‡•ç‡§ü‡§∞', '‡§á‡§Ç‡§∏‡•ç‡§ü‡•â‡§≤'],
            'CCTV': ['‡§®‡§Ø‡§æ ‡§ï‡•à‡§Æ‡§∞‡§æ', 'DVR ‡§ö‡•á‡§ï', '‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏'],
            'AC SERVICE': ['‡§ó‡•à‡§∏ ‡§ö‡§æ‡§∞‡•ç‡§ú', 'AC ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏', 'PCB'],
            'CLEANING': ['‡§°‡•Ä‡§™ ‡§ï‡•ç‡§≤‡•Ä‡§®', '‡§∏‡•ã‡§´‡§æ', '‡§ü‡§Ç‡§ï‡•Ä'],
            'FITTING': ['TV ‡§∏‡•ç‡§ü‡•à‡§Ç‡§°', '‡§™‡§∞‡•ç‡§¶‡§æ ‡§∞‡•â‡§°', '‡§Ü‡§à‡§®‡§æ'],
            'OTHER': ['‡§™‡•á‡§Ç‡§ü‡§∞', '‡§Æ‡§ø‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä', '‡§≤‡•á‡§¨‡§∞']
        };
        svcs[cat].forEach(s => {
            const d = document.createElement('div');
            d.className = 'box'; d.style.height = '60px';
            d.innerHTML = `<span>${s}</span>`;
            d.onclick = () => {
                document.getElementById('selSvc').value = cat + " - " + s;
                closeModal('subModal');
                showPage('booking-page', document.querySelectorAll('.nav-item')[1]);
            };
            list.appendChild(d);
        });
        openModal('subModal');
    }

    function getLoc() {
        navigator.geolocation.getCurrentPosition(() => {
            document.getElementById('locBtn').innerText = "‚úÖ ‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§!";
            document.getElementById('finalBtn').style.display = "block";
        });
    }

    async function trackJob() {
        const id = document.getElementById('tId').value;
        if(!id) return alert("ID ‡§°‡§æ‡§≤‡•á‡§Ç");
        const res = await fetch(`${scriptURL}?action=track&id=${id}`);
        const d = await res.json();
        document.getElementById('tRes').style.display = 'block';
        document.getElementById('tStat').innerText = d.currentStatus || "Record Not Found";
    }

    async function upStat(s) {
        const id = document.getElementById('targetId').value;
        if(!id) return alert("ID ‡§≠‡§∞‡•á‡§Ç");
        await fetch(`${scriptURL}?action=updateStatus&id=${id}&status=${s}`);
        alert("‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ: " + s);
    }

    async function loadData(type) {
        openModal('list-modal');
        document.getElementById('ltitle').innerText = type === 'CUST' ? "Customer Data" : "Team Data";
        document.getElementById('lbody').innerHTML = "Fetching Data...";
        const action = type === 'CUST' ? 'readBookings' : 'readTeam';
        const res = await fetch(`${scriptURL}?action=${action}`);
        const data = await res.json();
        let html = "";
        data.forEach(i => html += `<div style="padding:10px; border-bottom:1px solid #eee;">${i.name} - ${i.id}</div>`);
        document.getElementById('lbody').innerHTML = html || "No data found";
    }

    function sendWA() {
        const ph = document.getElementById('asPh').value;
        const msg = `‡§®‡§Ø‡§æ ‡§ü‡§æ‡§∏‡•ç‡§ï: ‡§ï‡§∏‡•ç‡§ü. ID ${document.getElementById('asC').value}`;
        window.open(`https://wa.me/91${ph}?text=${encodeURIComponent(msg)}`);
    }

    // Slider
    let sIdx = 0; setInterval(() => { const s = document.getElementById('mainSlider'); if(s) { sIdx = (sIdx + 1) % 5; s.style.transform = `translateX(${-sIdx * 20}%)`; } }, 3500);
</script>

</body>
</html>
