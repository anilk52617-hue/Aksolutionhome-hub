<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AK SOLUTION HUB - Final Admin Integrated</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --primary: #005eb8; --bg: #ffffff; --success: #27ae60; }
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; }
        body { background: var(--bg); padding-bottom: 90px; overflow-x: hidden; }
        
        .header { text-align: center; padding: 10px; background: #fff; border-bottom: 1px solid #ddd; }
        .logo-img { width: 75px; height: 75px; border-radius: 50%; border: 2px solid var(--primary); }
        .header h1 { color: var(--primary); font-size: 22px; font-weight: 800; }
        .ticker { background: var(--primary); color: #fff; padding: 8px; overflow: hidden; white-space: nowrap; font-size: 13px; font-weight: bold; }
        
        .slider-box { width: 94%; margin: 15px auto; border-radius: 15px; overflow: hidden; height: 170px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .slider { display: flex; transition: 0.5s; height: 100%; width: 500%; }
        .slider img { width: 20%; flex-shrink: 0; object-fit: cover; }
        
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; }
        .box { background: #f8f9fa; border-radius: 12px; height: 95px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 1px solid #eee; cursor: pointer; transition: 0.2s; }
        .box:active { transform: scale(0.95); background: #eee; }
        .box i { font-size: 24px; color: var(--primary); margin-bottom: 5px; }
        .box span { font-size: 10px; font-weight: 800; color: #333; text-align: center; text-transform: uppercase; }

        #admin-panel-content { background: #ffffff; padding-bottom: 20px; display: none; }
        .dashboard-stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; padding: 10px; }
        .stat-box { border-radius: 8px; padding: 12px 0; text-align: center; color: white; border: 2px solid #333; cursor: pointer; font-size: 10px; font-weight: bold; }
        .bg-pending { background: #f1c40f; color: #000; }
        .bg-running { background: #3498db; }
        .bg-done    { background: #27ae60; }
        .bg-reject  { background: #e74c3c; }
        
        .admin-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; padding: 15px; }
        .adm-box { background: #fff; border-radius: 12px; height: 90px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 2px solid #333; box-shadow: 4px 4px 0px #333; transition: 0.2s; cursor: pointer; }
        .adm-box:active { transform: translate(2px, 2px); box-shadow: none; }
        .adm-box span { font-size: 10px; font-weight: 900; color: #000; text-align: center; }

        .page { display: none; padding: 20px; animation: fadeIn 0.3s; }
        .active-page { display: block !important; }
        @keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
        
        .nav-bar { position: fixed; bottom: 0; left: 0; right: 0; background: #fff; display: flex; height: 75px; border-top: 1px solid #eee; z-index: 10000; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
        .nav-item { flex: 1; text-align: center; color: #666; font-size: 11px; padding-top: 15px; cursor: pointer; }
        .nav-item i { font-size: 22px; display: block; margin-bottom: 4px; }
        .active-nav { color: var(--primary); font-weight: bold; }
        
        .input { width: 100%; padding: 12px; margin: 10px 0; border: 1.5px solid #ddd; border-radius: 8px; font-size: 16px; outline: none; }
        .btn-ok { width: 100%; padding: 15px; background: var(--success); color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
        
        /* Modals */
        #admin-form-modal, #sheet-data-modal { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); width:95%; max-width:400px; background:white; padding:20px; border-radius:15px; box-shadow:0 0 30px rgba(0,0,0,0.5); z-index:30000; text-align:center; border: 2px solid var(--primary); }
        #sheet-data-modal { width: 98%; max-width: 800px; height: 85vh; overflow-y: auto; }
        
        .data-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 10px; }
        .data-table th, .data-table td { border: 1px solid #ddd; padding: 6px; text-align: left; }
        .data-table th { background: var(--primary); color: white; position: sticky; top: 0; }
        .data-table tr:nth-child(even) { background: #f2f2f2; }
        
        .result-box { background:#f8f9fa; padding:15px; border-radius:10px; border:2px solid var(--primary); margin-top:10px; text-align:left; }
    </style>
</head>
<body>

<div class="header"><img src="57255.jpg" class="logo-img"><h1>AK SOLUTION HUB</h1></div>
<div class="ticker"><marquee>‚ö° ‡§∏‡•Ä‡§∏‡•Ä‡§ü‡•Ä‡§µ‡•Ä | ‡§Ü‡§∞‡§ì | ‡§™‡•ç‡§≤‡§Ç‡§¨‡§∞ | ‡§ï‡§æ‡§∞‡§™‡•á‡§Ç‡§ü‡§∞ | ‡§è‡§∏‡•Ä ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ | 9927464530 ‚ö°</marquee></div>

<div id="home-page" class="page active-page">
    <div class="slider-box"><div class="slider" id="mainSlider"><img src="1.jpg"><img src="2.jpg"><img src="3.jpg"><img src="4.jpg"><img src="5.jpg"></div></div>
    <div class="grid" id="main-grid">
        <div class="box" onclick="openSub('PLUMBER')"><i class="fas fa-faucet"></i><span>PLUMBER</span></div>
        <div class="box" onclick="openSub('ELECTRICIAN')"><i class="fas fa-bolt"></i><span>ELECTRICIAN</span></div>
        <div class="box" onclick="openSub('CARPENTER')"><i class="fas fa-hammer"></i><span>CARPENTER</span></div>
        <div class="box" onclick="openSub('RO SERVICE')"><i class="fas fa-tint"></i><span>RO SERVICE</span></div>
        <div class="box" onclick="openSub('CCTV')"><i class="fas fa-video"></i><span>CCTV</span></div>
        <div class="box" onclick="openSub('FITTING')"><i class="fas fa-tools"></i><span>FITTING</span></div>
        <div class="box" onclick="openSub('CLEANING')"><i class="fas fa-broom"></i><span>CLEANING</span></div>
        <div class="box" onclick="openSub('AC SERVICE')"><i class="fas fa-snowflake"></i><span>AC SERVICE</span></div>
        <div class="box" onclick="openSub('OTHER')"><i class="fas fa-plus-circle"></i><span>OTHER</span></div>
    </div>
</div>

<div id="booking-page" class="page">
    <h2 id="svc-title" style="text-align:center; color:var(--primary); margin-bottom:15px;">‡§∏‡•á‡§µ‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç</h2>
    <input type="text" id="uName" class="input" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ">
    <input type="tel" id="uPhone" class="input" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞">
    <textarea id="uAddr" class="input" rows="3" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§™‡§§‡§æ"></textarea>
    <button class="btn-ok" id="locBtn" onclick="askLocation()" style="background:#3498db;">üìç 1. ‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§¶‡•á‡§Ç (GPS)</button>
    <button class="btn-ok" id="finalBtn" onclick="finalSubmit()" style="display:none; margin-top:10px;">‚úÖ 2. ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó : OK</button>
</div>

<div id="track-page" class="page"> 
    <h2 style="text-align:center;">üîç ‡§ü‡•ç‡§∞‡•à‡§ï ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏</h2> 
    <input type="text" id="trackId" class="input" placeholder="AK-ID ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç (‡§â‡§¶‡§æ: AK-1120)"> 
    <button class="btn-ok" style="background:var(--primary);" onclick="trackOrder()">‡§ñ‡•ã‡§ú‡•á‡§Ç</button> 
    <div id="track-result" style="margin-top:20px; text-align:center;"></div>
</div>

<div id="reviews-page" class="page"> 
    <h2 style="text-align:center;">‚≠ê ‡§∞‡§ø‡§µ‡•ç‡§Ø‡•Ç ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ</h2> 
    <input type="text" id="revName" class="input" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ">
    <select id="revStar" class="input">
        <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
        <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option>
        <option value="3">‚≠ê‚≠ê‚≠ê</option>
        <option value="2">‚≠ê‚≠ê</option>
        <option value="1">‚≠ê</option>
    </select>
    <textarea id="revMsg" class="input" placeholder="‡§Ö‡§™‡§®‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§≤‡§ø‡§ñ‡•á‡§Ç..." rows="5"></textarea> 
    <button class="btn-ok" onclick="submitReview()">‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§∞‡§ø‡§µ‡•ç‡§Ø‡•Ç</button> 
</div>

<div id="admin-page" class="page">
    <div id="admin-login-box">
        <h2 style="text-align:center;">üîê ‡§è‡§°‡§Æ‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§®</h2>
        <input type="password" id="pin" class="input" placeholder="‡§™‡§ø‡§® ‡§°‡§æ‡§≤‡•á‡§Ç">
        <button class="btn-ok" style="background:#333;" onclick="checkAdmin()">‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§ñ‡•ã‡§≤‡•á‡§Ç</button>
    </div>
    
    <div id="admin-panel-content">
        <h2 style="text-align:center; color:#005eb8; font-size: 18px; text-decoration: underline;">ADMIN DASHBOARD</h2>
        <input type="text" id="updId" class="input" style="border:2px solid var(--primary);" placeholder="ID ‡§°‡§æ‡§≤‡•á‡§Ç (‡§â‡§¶‡§æ: AK-1120)">
        
        <div class="dashboard-stats">
            <div class="stat-box bg-done" onclick="updStatus('DONE')">DONE</div>
            <div class="stat-box bg-pending" onclick="updStatus('PENDING')">PENDING</div>
            <div class="stat-box bg-running" onclick="updStatus('RUNNING')">RUNNING</div>
            <div class="stat-box bg-reject" onclick="updStatus('REJECT')">REJECT</div>
        </div>
        <div class="admin-grid">
            <div class="adm-box" onclick="openAdmForm('REG')"><span>TEAM REG</span></div>
            <div class="adm-box" onclick="openAdmForm('ID')"><span>ID CARD</span></div>
            <div class="adm-box" onclick="openAdmForm('TASK')"><span>ASSIGN</span></div>
            <div class="adm-box" style="background:#e3f2fd;" onclick="viewList('TEAM')"><span>TEAM LIST</span></div>
            <div class="adm-box" style="background:#e8f5e9;" onclick="viewList('AK')"><span>CUST LIST</span></div>
            <div class="adm-box" style="background:#fff3e0;" onclick="loadFullSheet()"><span>SHEET DATA</span></div>
        </div>
    </div>
</div>

<div id="admin-form-modal">
    <h3 id="form-head">‡§µ‡§ø‡§µ‡§∞‡§£</h3>
    <input type="text" id="fName" class="input" placeholder="‡§®‡§æ‡§Æ">
    <input type="tel" id="fPhone" class="input" placeholder="‡§®‡§Ç‡§¨‡§∞">
    <button class="btn-ok" id="formSubmitBtn">‡§ï‡§®‡•ç‡§´‡§∞‡•ç‡§Æ</button>
    <button onclick="closeAdmForm()" style="background:none; border:none; color:gray; margin-top:10px; cursor:pointer;">‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
</div>

<div id="sheet-data-modal">
    <h2 style="color:var(--primary); margin-bottom: 10px;">LIVE DATABASE</h2>
    <div id="sheet-table-container" style="overflow-x: auto;">‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
    <button class="btn-ok" onclick="document.getElementById('sheet-data-modal').style.display='none'" style="background:#333; margin-top:15px;">‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
</div>

<div class="nav-bar">
    <div class="nav-item active-nav" onclick="showPage('home-page', this)"><i class="fas fa-home"></i>Home</div>
    <div class="nav-item" onclick="showPage('booking-page', this)"><i class="fas fa-calendar-alt"></i>Booking</div>
    <div class="nav-item" onclick="showPage('track-page', this)"><i class="fas fa-search-location"></i>Track</div>
    <div class="nav-item" onclick="showPage('reviews-page', this)"><i class="fas fa-star"></i>Reviews</div>
    <div class="nav-item" onclick="showPage('admin-page', this)"><i class="fas fa-user-shield"></i>Admin</div>
</div>

<script>
    // ‡§Ü‡§™‡§ï‡§æ ‡§®‡§Ø‡§æ ‡§≤‡§ø‡§Ç‡§ï ‡§Ø‡§π‡§æ‡§Å ‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxa_iIYrtRL9iEhn2pDaOarZRazqx_R2RUbLwFWjSPiTx4BBEt9Gq2Fr-I0sRPe_eQnug/exec';
    
    let userGPS = "Link not generated";
    let currentOTP = "";

    function showPage(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
        document.getElementById(id).classList.add('active-page');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active-nav'));
        if(el) el.classList.add('active-nav');
    }

    function checkAdmin() {
        if(document.getElementById('pin').value === "Ak2525") {
            document.getElementById('admin-login-box').style.display = 'none';
            document.getElementById('admin-panel-content').style.display = 'block';
        } else alert("‡§ó‡§≤‡§§ ‡§™‡§ø‡§®!");
    }

    function openSub(cat) {
        let grid = document.getElementById('main-grid');
        const subData = {
            'PLUMBER': ['‡§®‡§≤ ‡§∞‡§ø‡§™‡•á‡§Ø‡§∞', '‡§≤‡•Ä‡§ï‡•á‡§ú', '‡§ü‡§Ç‡§ï‡•Ä ‡§∏‡§´‡§æ‡§à', '‡§ó‡•Ä‡§ú‡§∞'],
            'ELECTRICIAN': ['‡§¨‡•ã‡§∞‡•ç‡§° ‡§´‡§ø‡§ü‡§ø‡§Ç‡§ó', '‡§™‡§Ç‡§ñ ‡§∞‡§ø‡§™‡•á‡§Ø‡§∞', '‡§≤‡§æ‡§á‡§ü', '‡§á‡§®‡§µ‡§∞‡•ç‡§ü‡§∞'],
            'RO SERVICE': ['‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏‡§ø‡§Ç‡§ó', '‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ö‡•á‡§Ç‡§ú', '‡§®‡§Ø‡§æ RO', '‡§≤‡•Ä‡§ï‡•á‡§ú'],
            'CCTV': ['‡§®‡§Ø‡§æ ‡§ï‡•à‡§Æ‡§∞‡§æ', 'DVR ‡§ö‡•á‡§ï', '‡§µ‡§æ‡§Ø‡§∞‡§ø‡§Ç‡§ó', '‡§∞‡§ø‡§™‡•á‡§Ø‡§∞'],
            'AC SERVICE': ['‡§ó‡•à‡§∏ ‡§∞‡§ø‡§´‡§ø‡§≤', '‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏‡§ø‡§Ç‡§ó', '‡§≤‡•Ä‡§ï‡•á‡§ú', '‡§è‡§∏‡•Ä ‡§´‡§ø‡§ü‡§ø‡§Ç‡§ó'],
            'CARPENTER': ['‡§§‡§æ‡§≤‡§æ ‡§∞‡§ø‡§™‡•á‡§Ø‡§∞', '‡§¶‡§∞‡§µ‡§æ‡§ú‡§æ', '‡§™‡•â‡§≤‡§ø‡§∂', '‡§¨‡•á‡§°'],
            'FITTING': ['‡§¨‡§æ‡§•‡§∞‡•Ç‡§Æ ‡§´‡§ø‡§ü‡§ø‡§Ç‡§ó', '‡§ï‡§ø‡§ö‡§®', 'TV ‡§Æ‡§æ‡§â‡§Ç‡§ü'],
            'CLEANING': ['‡§ò‡§∞ ‡§ï‡•Ä ‡§∏‡§´‡§æ‡§à', '‡§∏‡•ã‡§´‡§æ', '‡§¨‡§æ‡§•‡§∞‡•Ç‡§Æ'],
            'OTHER': ['‡§™‡•á‡§Ç‡§ü‡§ø‡§Ç‡§ó', '‡§µ‡•á‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó', '‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§´‡§ø‡§ü‡§ø‡§Ç‡§ó']
        };
        let html = `<h3 style="grid-column: span 3; text-align:center; color:var(--primary); padding:10px;">${cat} ‡§ö‡•Å‡§®‡•á‡§Ç</h3>`;
        subData[cat].forEach(s => { html += `<div class="box" onclick="goBook('${cat} - ${s}')"><span>${s}</span></div>`; });
        html += `<button onclick="location.reload()" style="grid-column: span 3; background:#333; color:white; border:none; padding:15px; border-radius:10px; margin-top:10px;">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</button>`;
        grid.innerHTML = html;
        window.scrollTo(0,0);
    }

    function goBook(svc) { 
        document.getElementById('svc-title').innerText = svc; 
        showPage('booking-page', document.querySelectorAll('.nav-item')[1]); 
    }
    
    function askLocation() { 
        if (navigator.geolocation) { 
            document.getElementById('locBtn').innerText = "‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç..."; 
            navigator.geolocation.getCurrentPosition((pos) => { 
                userGPS = `https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`; 
                document.getElementById('locBtn').innerText = "‚úÖ ‡§≤‡•ã‡§ï‡•á‡§∂‡§® OK"; 
                document.getElementById('finalBtn').style.display = "block"; 
            }, () => { alert("‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§"); }); 
        } 
    }
    
    function finalSubmit() { 
        const n = document.getElementById('uName').value; 
        const p = document.getElementById('uPhone').value; 
        const a = document.getElementById('uAddr').value; 
        const s = document.getElementById('svc-title').innerText; 
        if(!n || !p || !a) return alert("‡§∏‡§≠‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç!"); 
        
        const bid = "AK-" + Math.floor(1000 + Math.random() * 9000); 
        const dStr = new Date().toLocaleDateString('en-GB'); 

        fetch(`${scriptURL}?action=booking&date=${dStr}&id=${bid}&name=${encodeURIComponent(n)}&phone=${p}&address=${encodeURIComponent(a)}&service=${encodeURIComponent(s)}&location=${encodeURIComponent(userGPS)}&status=PENDING`, { mode: 'no-cors' }).then(() => {
            const waMsg = `*AK SOLUTION HUB - ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó*%0AüÜî ‡§Ü‡§à‡§°‡•Ä: ${bid}%0Aüõ†Ô∏è ‡§∏‡•á‡§µ‡§æ: ${s}%0Aüë§ ‡§®‡§æ‡§Æ: ${n}%0Aüìû ‡§´‡•ã‡§®: ${p}%0Aüè† ‡§™‡§§‡§æ: ${a}%0Aüìç ‡§≤‡•ã‡§ï‡•á‡§∂‡§®: ${userGPS}`;
            window.open(`https://wa.me/919927464530?text=${waMsg}`); 
            alert("‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡§´‡§≤! ‡§Ü‡§à‡§°‡•Ä: " + bid); 
            location.reload(); 
        });
    }

    async function trackOrder() {
        const tid = document.getElementById('trackId').value.trim();
        if(!tid) return alert("ID ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç!");
        document.getElementById('track-result').innerHTML = "‡§ñ‡•ã‡§ú ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...";
        try {
            const res = await fetch(`${scriptURL}?action=track&id=${tid}`);
            const data = await res.json();
            if(data.status === "Found") {
                document.getElementById('track-result').innerHTML = `<div class="result-box">üë§ <b>‡§®‡§æ‡§Æ:</b> ${data.name}<br>üõ†Ô∏è <b>‡§∏‡•á‡§µ‡§æ:</b> ${data.service}<br>‚ö° <b>‡§∏‡•ç‡§ü‡•á‡§ü‡§∏:</b> <span style="color:var(--primary); font-weight:bold;">${data.jobStatus}</span></div>`;
            } else { document.getElementById('track-result').innerHTML = "‚ùå ‡§Ü‡§à‡§°‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä!"; }
        } catch(e) { document.getElementById('track-result').innerHTML = "‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§è‡§∞‡§∞!"; }
    }

    function updStatus(st) { 
        const targetId = document.getElementById('updId').value.trim();
        if(!targetId) return alert("ID ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç!");
        fetch(`${scriptURL}?action=updateStatus&id=${targetId}&status=${st}`, { mode: 'no-cors' }).then(() => {
            alert("‡§∏‡•ç‡§ü‡•á‡§ü‡§∏ " + st + " ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ!");
            document.getElementById('updId').value = "";
        });
    }

    function submitReview() {
        const name = document.getElementById('revName').value;
        const star = document.getElementById('revStar').value;
        const msg = document.getElementById('revMsg').value;
        if(!name || !msg) return alert("‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç!");
        fetch(`${scriptURL}?action=booking&name=${encodeURIComponent(name)}&service=REVIEW&address=${encodeURIComponent(msg)}&status=${star}Star`, { mode: 'no-cors' }).then(() => {
            alert("‡§∂‡•Å‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ! ‡§∞‡§ø‡§µ‡•ç‡§Ø‡•Ç ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§π‡•Å‡§Ü‡•§"); location.reload();
        });
    }

    function openAdmForm(action) {
        const modal = document.getElementById('admin-form-modal');
        const head = document.getElementById('form-head');
        const submitBtn = document.getElementById('formSubmitBtn');
        const fName = document.getElementById('fName');
        const fPhone = document.getElementById('fPhone');

        modal.style.display = 'block';
        fName.value = ""; fPhone.value = ""; fPhone.style.display = "block";

        if(action === 'REG') {
            head.innerText = "Team Registration (OTP)";
            submitBtn.innerText = "1. Send OTP";
            submitBtn.onclick = function() {
                if(!fPhone.value) return alert("‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡•á‡§Ç!");
                currentOTP = Math.floor(1000 + Math.random() * 9000).toString();
                let n = fName.value, p = fPhone.value;
                window.open(`https://wa.me/91${p}?text=‡§Ü‡§™‡§ï‡§æ AK ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§ï‡•ã‡§° ‡§π‡•à: *${currentOTP}*`);
                submitBtn.innerText = "2. Verify OTP";
                fName.value = ""; fName.placeholder = "‡§Ø‡§π‡§æ‡§Å OTP ‡§°‡§æ‡§≤‡•á‡§Ç"; fPhone.style.display = "none";
                submitBtn.onclick = function() {
                    if(fName.value === currentOTP) {
                        let tid = "TEAM-" + Math.floor(100+Math.random()*900);
                        fetch(`${scriptURL}?action=reg&id=${tid}&name=${encodeURIComponent(n)}&phone=${p}&service=TEAM_REG&status=VERIFIED`, {mode:'no-cors'});
                        alert("‡§∏‡§´‡§≤! ‡§ü‡•Ä‡§Æ ‡§Ü‡§à‡§°‡•Ä: " + tid); closeAdmForm();
                    } else alert("‡§ó‡§≤‡§§ OTP!");
                };
            };
        } 
        else if(action === 'TASK') {
            head.innerText = "Assign Task";
            fName.placeholder = "‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞ ‡§µ‡§ø‡§µ‡§∞‡§£"; fPhone.placeholder = "‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§®‡§Ç‡§¨‡§∞";
            submitBtn.onclick = function() {
                window.open(`https://wa.me/91${fPhone.value}?text=*NEW TASK ASSIGNED*%0A${fName.value}`);
                fetch(`${scriptURL}?action=booking&name=${encodeURIComponent(fName.value)}&phone=${fPhone.value}&id=TASK&service=ASSIGN&status=ASSIGNED`, {mode:'no-cors'});
                alert("‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§∏‡•å‡§Ç‡§™ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ!"); closeAdmForm();
            };
        }
        else {
            head.innerText = "ID Card Generator";
            submitBtn.onclick = function() {
                let cid = "AK-ID-" + Math.floor(1000+Math.random()*9000);
                window.open(`https://wa.me/91${fPhone.value}?text=*AK SOLUTION HUB ID*%0AID: ${cid}%0AName: ${fName.value}`);
                fetch(`${scriptURL}?action=booking&name=${encodeURIComponent(fName.value)}&phone=${fPhone.value}&id=${cid}&service=ADMIN_ID&status=ISSUED`, {mode:'no-cors'});
                alert("‡§Ü‡§à‡§°‡•Ä ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ú‡§æ‡§∞‡•Ä!"); closeAdmForm();
            };
        }
    }

    async function viewList(type) {
        alert("‡§∏‡•Ç‡§ö‡•Ä ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à, ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç...");
        try {
            const res = await fetch(`${scriptURL}?action=getList&type=${type}`);
            const data = await res.json();
            if(!data.length) return alert("‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ!");
            let txt = `üìã ${type} LIST:\n\n`;
            data.forEach((item, i) => { txt += `${i+1}. ${item.name} (${item.id}) - ${item.status}\nüìû ${item.phone}\n\n`; });
            alert(txt);
        } catch(e) { alert("‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§´‡§≤!"); }
    }

    async function loadFullSheet() {
        const modal = document.getElementById('sheet-data-modal');
        const container = document.getElementById('sheet-table-container');
        modal.style.display = 'block';
        container.innerHTML = "<p style='padding:20px;'>‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à, ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡•Å‡§ï‡•á‡§Ç...</p>";
        try {
            const res = await fetch(`${scriptURL}?action=getList&type=`); 
            const data = await res.json();
            if(!data.length) { container.innerHTML = "‡§∂‡•Ä‡§ü ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•à!"; return; }
            
            let html = `<table class="data-table">
                <tr><th>ID</th><th>‡§®‡§æ‡§Æ</th><th>‡§´‡•ã‡§®</th><th>‡§§‡§æ‡§∞‡•Ä‡§ñ</th><th>‡§∏‡•ç‡§ü‡•á‡§ü‡§∏</th></tr>`;
            data.forEach(r => { 
                html += `<tr>
                    <td>${r.id}</td>
                    <td>${r.name}</td>
                    <td>${r.phone}</td>
                    <td>${r.date || '-'}</td>
                    <td style="font-weight:bold; color:var(--primary);">${r.status}</td>
                </tr>`; 
            });
            html += `</table>`;
            container.innerHTML = html;
        } catch(e) { container.innerHTML = "‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§è‡§∞‡§∞: ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ‡•§"; }
    }

    function closeAdmForm() { document.getElementById('admin-form-modal').style.display = 'none'; }
    
    // Slider Logic
    let idx = 0; setInterval(() => { 
        const s = document.getElementById('mainSlider'); 
        if(s) { idx = (idx + 1) % 5; s.style.transform = `translateX(${-idx * 20}%)`; } 
    }, 3500);
</script>
</body>
</html>
